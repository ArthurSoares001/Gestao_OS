unit frameCabecalhoControle;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes,
  Vcl.Graphics, Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.Buttons,
  Vcl.ExtCtrls, OrEdit, Datamodule, OrComboBox, Biblioteca, Constantes;

type
  TfraCabecalhoControle = class(TFrame)
    pnCabecalho: TPanel;
    cmbTipo: TOrComboBox;
    spdProcurar: TSpeedButton;
    edtDescricao: TOrEdit;
    pnlNovo: TPanel;
    btnNovo: TSpeedButton;
    Label1: TLabel;
    Label2: TLabel;
    rgOrdenar: TRadioGroup;
    procedure edtDescricaoChange(Sender: TObject);
  private
    { Private declarations }
    form: TForm;
  public
    { Public declarations }
    procedure iniciar(form: TForm; NovoFiltro: String = NULL_STRING);
    procedure FrameKeyPress(Sender: TObject; var Key: Char);
    procedure alterarNomeItemTipo(const NovoNome: string);
  end;

implementation

{$R *.dfm}

{ TfraCabecalhoControle }


{ TfraCabecalhoControle }

procedure TfraCabecalhoControle.alterarNomeItemTipo(const NovoNome: string);
begin
  if cmbTipo.Items.Count > 0 then
    cmbTipo.Items[0] := NovoNome;
end;


procedure TfraCabecalhoControle.edtDescricaoChange(Sender: TObject);
begin
  cmbTipo.ItemIndex := escolherFiltroMercadoria(cmbTipo, edtDescricao.Text);
end;

procedure TfraCabecalhoControle.FrameKeyPress(Sender: TObject; var Key: Char);
begin
  if key = KEY_ENTER then
  begin
    if (edtDescricao.Focused) then
      spdProcurar.OnClick(self)
    else
    begin
      key := KEY_TAB;
      Perform(WM_NEXTDLGCTL, 0, 0);
    end;
  end;
end;

procedure TfraCabecalhoControle.iniciar(form: TForm; NovoFiltro: String);
begin
  self.form := form;
  UsarArredondarView(pnlNovo);
  UsarArredondarView(edtDescricao);
  spdProcurar.Hint := 'Procurar F3';
  btnNovo.Hint := 'Novo F2';
  edtDescricao.MaxLength := 250;
  edtDescricao.Hint := 'Filtro';
  edtDescricao.OnKeyPress := FrameKeyPress;
  if (NovoFiltro <> NULL_STRING) then
    cmbTipo.Items.Add(NovoFiltro);
end;

end.
